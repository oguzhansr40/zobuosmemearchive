<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OGY MEME VIDEO</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* --- CSS DEĞİŞKENLERİ (TEMALAR) --- */
        :root {
            /* Varsayılan değerleri buraya yazıyoruz ama JS ile kontrol edip değiştireceğiz.
               Alttaki [data-theme="dark"] ve normal root ayrımı korunuyor. */
            --bg-color: #f4f4f4;
            --bg-secondary: #ffffff;
            --text-color: #333333;
            --accent-color: #ff8c00; /* Turuncu tonları (Açık Tema) */
            --accent-hover: #e07b00;
            --border-color: #ddd;
            --card-shadow: 0 4px 6px rgba(0,0,0,0.1);
            --scrollbar-bg: #e0e0e0;
            --scrollbar-thumb: #ff8c00;
        }

        [data-theme="dark"] {
            /* Koyu Tema Değişkenleri */
            --bg-color: #121212;
            --bg-secondary: #1e1e1e;
            --text-color: #f0f0f0;
            --accent-color: #40E0D0; /* Turkuaz tonları */
            --accent-hover: #36c2b3;
            --border-color: #333;
            --card-shadow: 0 4px 6px rgba(0,0,0,0.5);
            --scrollbar-bg: #2c2c2c;
            --scrollbar-thumb: #40E0D0;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-y: scroll;
        }

        /* --- SCROLLBAR --- */
        ::-webkit-scrollbar {
            width: 10px;
        }
        ::-webkit-scrollbar-track {
            background: var(--scrollbar-bg); 
        }
        ::-webkit-scrollbar-thumb {
            background: var(--scrollbar-thumb); 
            border-radius: 5px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent-hover); 
        }

        /* --- HEADER --- */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 30px;
            background-color: var(--bg-secondary);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .site-name {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent-color);
            letter-spacing: 1px;
        }

        /* Arama Kutusu */
        .search-container {
            flex: 1;
            display: flex;
            justify-content: center;
            margin: 0 20px;
        }

        .search-input {
            width: 50%;
            padding: 10px 15px;
            border-radius: 20px;
            border: 2px solid var(--border-color);
            background-color: var(--bg-color);
            color: var(--text-color);
            outline: none;
            transition: border-color 0.3s;
        }
        
        .search-input:focus {
            border-color: var(--accent-color);
        }

        /* Sağ Butonlar */
        .header-buttons {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .icon-btn {
            background: none;
            border: none;
            color: var(--text-color);
            font-size: 1.5rem;
            cursor: pointer;
            transition: transform 0.2s, color 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
        }

        .icon-btn:hover {
            background-color: rgba(128, 128, 128, 0.1);
            color: var(--accent-color);
        }

        /* Tema Butonu Animasyonu */
        #theme-btn i {
            transition: transform 0.5s ease;
        }
        
        /* --- MAIN GRID --- */
        main {
            flex: 1;
            padding: 20px;
        }

        #video-grid {
            display: grid;
            /* İstenilen: Tam 8 adet yan yana */
            grid-template-columns: repeat(8, 1fr);
            gap: 15px;
        }

        /* Kart Yapısı */
        .video-card {
            background-color: var(--bg-secondary);
            border-radius: 8%; /* İstenilen ovallik */
            overflow: hidden;
            box-shadow: var(--card-shadow);
            position: relative;
            display: flex;
            flex-direction: column;
            aspect-ratio: 9/12; /* Kart oranı */
            transition: transform 0.2s;
        }

        .video-card:hover {
            transform: translateY(-5px);
        }

        .card-thumb {
            width: 100%;
            height: 75%;
            object-fit: cover;
            background-color: #000;
            cursor: pointer;
        }

        .card-info {
            height: 25%;
            padding: 5px 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--text-color);
            word-break: break-word;
        }

        /* Kart Menüsü (3 Nokta) */
        .card-menu-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            color: white;
            background-color: rgba(0,0,0,0.5);
            border-radius: 50%;
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: none;
            font-size: 0.8rem;
            z-index: 10;
        }

        .card-menu-options {
            position: absolute;
            top: 30px;
            right: 5px;
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 5px;
            display: none;
            flex-direction: column;
            z-index: 11;
            width: 100px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .card-menu-options.show {
            display: flex;
        }

        .menu-option {
            padding: 8px;
            cursor: pointer;
            font-size: 0.8rem;
            color: var(--text-color);
            text-align: left;
        }

        .menu-option:hover {
            background-color: var(--accent-color);
            color: #fff;
        }

        /* --- FOOTER --- */
        footer {
            padding: 20px;
            text-align: center;
            background-color: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            font-weight: bold;
        }

        /* --- FLOATING BUTTONS --- */
        .float-btn {
            position: fixed;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--accent-color);
            color: white;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 90;
        }

        .float-btn:hover {
            background-color: var(--accent-hover);
            transform: scale(1.1);
        }

        #btn-up { bottom: 20px; right: 20px; }
        #btn-random { bottom: 20px; left: 20px; }

        /* --- MODAL (POPUP) --- */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 200;
        }

        .modal-content {
            background-color: var(--bg-secondary);
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            position: relative;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
        }

        .modal-header {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 20px;
            color: var(--accent-color);
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .form-group input {
            width: 100%;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid var(--border-color);
            background-color: var(--bg-color);
            color: var(--text-color);
        }

        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }

        .btn {
            padding: 10px 20px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            font-weight: bold;
        }

        .btn-cancel { background-color: #ccc; color: #333; }
        .btn-save { background-color: var(--accent-color); color: white; }

        /* Video Oynatma Modalı (Tam ekran gibi) */
        #player-modal .modal-content {
            max-width: 800px;
            background-color: #000;
        }
        #video-player {
            width: 100%;
            max-height: 70vh;
        }

        /* --- RESPONSIVE --- */
        @media (max-width: 1200px) {
            .card-info { font-size: 0.7rem; }
            .card-menu-btn { width: 20px; height: 20px; font-size: 0.6rem; }
        }
    </style>
</head>
<body>

    <header>
        <div class="site-name">OGY MEME VIDEO</div>
        
        <div class="search-container">
            <input type="text" id="search-input" class="search-input" placeholder="Video ara...">
        </div>

        <div class="header-buttons">
            <button id="theme-btn" class="icon-btn" title="Tema Değiştir">
                <i class="fa-solid fa-moon" id="theme-icon"></i>
            </button>
            <button id="add-btn" class="icon-btn" title="Video Ekle">
                <i class="fa-solid fa-plus"></i>
            </button>
        </div>
    </header>

    <main>
        <div id="video-grid">
            </div>
    </main>

    <footer>
        <span id="video-count">Toplam Video: 0</span>
    </footer>

    <button id="btn-random" class="float-btn" title="Rastgele Video">
        <i class="fa-solid fa-shuffle"></i>
    </button>
    <button id="btn-up" class="float-btn" title="Yukarı Çık">
        <i class="fa-solid fa-arrow-up"></i>
    </button>

    <div id="form-modal" class="modal-overlay">
        <div class="modal-content">
            <h3 id="modal-title" class="modal-header">Video Ekle</h3>
            <div class="form-group">
                <label>Video Adı:</label>
                <input type="text" id="video-name-input" placeholder="Meme adı giriniz...">
            </div>
            <div class="form-group" id="file-group">
                <label>Video Dosyası:</label>
                <input type="file" id="video-file-input" accept="video/*">
            </div>
            <div class="modal-actions">
                <button class="btn btn-cancel" id="close-modal-btn">İptal</button>
                <button class="btn btn-save" id="save-video-btn">Kaydet</button>
            </div>
        </div>
    </div>

    <div id="player-modal" class="modal-overlay">
        <div class="modal-content" style="text-align: center; position:relative;">
            <button onclick="closePlayer()" style="position: absolute; top: -10px; right: -10px; border-radius: 50%; width: 30px; height: 30px; border:none; background:white; cursor:pointer;">X</button>
            <video id="video-player" controls autoplay></video>
            <h3 id="playing-title" style="color: white; margin-top: 10px;"></h3>
        </div>
    </div>

    <script>
        /* --- VERİ YÖNETİMİ VE DEĞİŞKENLER --- */
        let videos = JSON.parse(localStorage.getItem('ogy_videos')) || [];
        
        // GÜNCELLEME: Varsayılan olarak KOYU tema.
        // Eğer daha önce kaydedilmiş bir tercih yoksa (null), 'true' (koyu) olsun.
        // Eğer kayıt varsa 'dark' mı diye baksın.
        const storedTheme = localStorage.getItem('ogy_theme');
        let isDarkMode = storedTheme ? (storedTheme === 'dark') : true;

        let currentEditId = null;

        /* --- ELEMENT SEÇİMLERİ --- */
        const themeBtn = document.getElementById('theme-btn');
        const themeIcon = document.getElementById('theme-icon');
        const grid = document.getElementById('video-grid');
        const searchInput = document.getElementById('search-input');
        const videoCountEl = document.getElementById('video-count');
        const addBtn = document.getElementById('add-btn');
        const formModal = document.getElementById('form-modal');
        const closeModalBtn = document.getElementById('close-modal-btn');
        const saveVideoBtn = document.getElementById('save-video-btn');
        const nameInput = document.getElementById('video-name-input');
        const fileInput = document.getElementById('video-file-input');
        const modalTitle = document.getElementById('modal-title');
        const fileGroup = document.getElementById('file-group');
        const btnUp = document.getElementById('btn-up');
        const btnRandom = document.getElementById('btn-random');
        const playerModal = document.getElementById('player-modal');
        const videoPlayer = document.getElementById('video-player');
        const playingTitle = document.getElementById('playing-title');

        /* --- TEMA YÖNETİMİ --- */
        function applyTheme() {
            if (isDarkMode) {
                document.body.setAttribute('data-theme', 'dark');
                themeIcon.className = 'fa-solid fa-moon'; // Koyu modda Ay ikonu
            } else {
                document.body.removeAttribute('data-theme');
                themeIcon.className = 'fa-solid fa-sun'; // Açık modda Güneş ikonu
            }
            localStorage.setItem('ogy_theme', isDarkMode ? 'dark' : 'light');
        }

        // Başlangıç temasını uygula
        applyTheme();

        // Tema butonuna tıklama
        themeBtn.addEventListener('click', () => {
            isDarkMode = !isDarkMode;
            applyTheme();
        });

        // Tema butonu hover animasyonu
        themeBtn.addEventListener('mouseenter', () => {
            // Güneş (Açık mod) ise -> üzerine gelince Ay olsun
            if (!isDarkMode) {
                themeIcon.className = 'fa-solid fa-moon';
                themeIcon.style.transform = 'rotate(360deg)';
            } 
            // Ay (Koyu mod) ise -> üzerine gelince Güneş olsun
            else {
                themeIcon.className = 'fa-solid fa-sun';
                themeIcon.style.transform = 'rotate(360deg)';
            }
        });

        themeBtn.addEventListener('mouseleave', () => {
            themeIcon.style.transform = 'rotate(0deg)';
            // Mouse gidince mevcut duruma geri dön
            if (!isDarkMode) {
                themeIcon.className = 'fa-solid fa-sun';
            } else {
                themeIcon.className = 'fa-solid fa-moon';
            }
        });

        /* --- VİDEO İŞLEMLERİ --- */

        // Listeyi Render Etme
        function renderVideos(filterText = '') {
            grid.innerHTML = '';
            
            // Alfabetik Sıralama
            const sortedVideos = videos.sort((a, b) => a.name.localeCompare(b.name, 'tr', { sensitivity: 'base' }));
            
            // Filtreleme
            const filteredVideos = sortedVideos.filter(v => v.name.toLowerCase().includes(filterText.toLowerCase()));

            filteredVideos.forEach(video => {
                const card = document.createElement('div');
                card.className = 'video-card';
                card.innerHTML = `
                    <button class="card-menu-btn" onclick="toggleMenu(event, '${video.id}')">
                        <i class="fa-solid fa-ellipsis"></i>
                    </button>
                    <div class="card-menu-options" id="menu-${video.id}">
                        <div class="menu-option" onclick="openEditModal('${video.id}')">Düzenle</div>
                        <div class="menu-option" onclick="deleteVideo('${video.id}')">Sil</div>
                    </div>
                    <video class="card-thumb" src="${video.src}#t=1.0" preload="metadata" onclick="playVideo('${video.id}')" muted></video>
                    <div class="card-info">${video.name}</div>
                `;
                grid.appendChild(card);
            });

            videoCountEl.textContent = `Toplam Video: ${filteredVideos.length}`;
        }

        // LocalStorage'a Kaydet
        function saveToStorage() {
            try {
                localStorage.setItem('ogy_videos', JSON.stringify(videos));
                renderVideos(searchInput.value);
            } catch (e) {
                alert("Hata: Tarayıcı depolama alanı doldu! Daha küçük videolar yükleyin veya bazılarını silin.");
            }
        }

        // Dosyayı Base64'e çevir
        const toBase64 = file => new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = () => resolve(reader.result);
            reader.onerror = error => reject(error);
        });

        // Video Ekleme / Kaydetme Butonu
        saveVideoBtn.addEventListener('click', async () => {
            const name = nameInput.value.trim();
            const file = fileInput.files[0];

            if (!name) {
                alert("Lütfen bir isim giriniz.");
                return;
            }

            // Düzenleme Modu
            if (currentEditId) {
                const videoIndex = videos.findIndex(v => v.id === currentEditId);
                if (videoIndex > -1) {
                    videos[videoIndex].name = name;
                    // Eğer yeni dosya seçildiyse güncelle
                    if (file) {
                        try {
                            const base64Video = await toBase64(file);
                            videos[videoIndex].src = base64Video;
                        } catch (e) {
                            alert("Video işlenirken hata oluştu.");
                            return;
                        }
                    }
                    saveToStorage();
                    closeModal();
                }
                return;
            }

            // Yeni Ekleme Modu
            if (!file) {
                alert("Lütfen bir video dosyası seçiniz.");
                return;
            }

            try {
                const base64Video = await toBase64(file);
                
                const newVideo = {
                    id: Date.now().toString(),
                    name: name,
                    src: base64Video
                };

                videos.push(newVideo);
                saveToStorage();
                closeModal();

            } catch (error) {
                console.error(error);
                alert("Video yüklenirken bir hata oluştu. Dosya boyutu çok büyük olabilir.");
            }
        });

        /* --- MODAL YÖNETİMİ --- */
        function openModal() {
            formModal.style.display = 'flex';
            currentEditId = null;
            modalTitle.textContent = "Video Ekle";
            nameInput.value = '';
            fileInput.value = '';
            fileGroup.style.display = 'block'; 
        }

        function closeModal() {
            formModal.style.display = 'none';
        }

        function openEditModal(id) {
            const video = videos.find(v => v.id === id);
            if (video) {
                currentEditId = id;
                modalTitle.textContent = "Video Düzenle";
                nameInput.value = video.name;
                fileInput.value = ''; 
                formModal.style.display = 'flex';
                document.getElementById(`menu-${id}`).classList.remove('show');
            }
        }

        addBtn.addEventListener('click', openModal);
        closeModalBtn.addEventListener('click', closeModal);

        window.addEventListener('click', (e) => {
            if (e.target === formModal) closeModal();
            if (e.target === playerModal) closePlayer();
            if (!e.target.closest('.card-menu-btn')) {
                document.querySelectorAll('.card-menu-options').forEach(el => el.classList.remove('show'));
            }
        });

        /* --- KART MENÜ İŞLEMLERİ --- */
        function toggleMenu(event, id) {
            event.stopPropagation();
            document.querySelectorAll('.card-menu-options').forEach(el => {
                if (el.id !== `menu-${id}`) el.classList.remove('show');
            });
            const menu = document.getElementById(`menu-${id}`);
            menu.classList.toggle('show');
        }

        function deleteVideo(id) {
            if (confirm("Bu videoyu silmek istediğinize emin misiniz?")) {
                videos = videos.filter(v => v.id !== id);
                saveToStorage();
            }
        }

        /* --- VİDEO OYNATMA --- */
        function playVideo(id) {
            const video = videos.find(v => v.id === id);
            if (video) {
                videoPlayer.src = video.src;
                playingTitle.textContent = video.name;
                playerModal.style.display = 'flex';
            }
        }

        function closePlayer() {
            playerModal.style.display = 'none';
            videoPlayer.pause();
            videoPlayer.src = "";
        }

        /* --- SEARCH --- */
        searchInput.addEventListener('input', (e) => {
            renderVideos(e.target.value);
        });

        /* --- FLOATING BUTTONS --- */
        btnUp.addEventListener('click', () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        btnRandom.addEventListener('click', () => {
            if (videos.length === 0) {
                alert("Henüz hiç video yok!");
                return;
            }
            const randomIndex = Math.floor(Math.random() * videos.length);
            const randomVideo = videos[randomIndex];
            playVideo(randomVideo.id);
        });

        /* --- BAŞLANGIÇ --- */
        renderVideos();

    </script>
</body>
</html>
