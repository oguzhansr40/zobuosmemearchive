<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>OGY MEME ARCHIVE</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ---------------------- GENEL ---------------------- */
* { margin:0; padding:0; box-sizing:border-box; }
body {
    font-family: Arial;
    background: var(--bg);
    color: var(--text);
    transition: .3s;
    overflow-x:hidden;
}

body.light {
    --bg:#fff4e3;
    --text:#222;
    --card:#ffdfb8;
    --primary:#ff8c1a;
}

body.dark {
    --bg:#0d1117;
    --text:#dffeff;
    --card:#18222d;
    --primary:#0bbbbb;
}

/* ---------------------- NAVBAR ---------------------- */
.navbar {
    width:100%;
    padding:15px 25px;
    background:var(--card);
    display:flex;
    justify-content:space-between;
    align-items:center;
    border-bottom:3px solid var(--primary);
    position:sticky;
    top:0;
    z-index:10;
}
.logo { font-size:22px; font-weight:bold; }
.icon-btn {
    background:none;
    border:none;
    font-size:22px;
    cursor:pointer;
    margin-left:15px;
    color:var(--primary);
}

/* ---------------------- LOGIN ---------------------- */
#loginScreen {
    position:fixed;
    top:0; left:0;
    width:100%; height:100%;
    background:#000000cc;
    display:flex;
    justify-content:center;
    align-items:center;
    z-index:9999;
}
.login-box {
    background:white;
    width:320px;
    padding:25px;
    border-radius:12px;
    text-align:center;
}
.login-box input {
    width:100%;
    padding:10px;
    margin-top:10px;
    border:1px solid #ccc;
    border-radius:6px;
}
.login-box button {
    margin-top:15px;
    width:100%;
    padding:10px;
    border:none;
    background:#0bbbbb;
    color:white;
    font-weight:bold;
    border-radius:6px;
    cursor:pointer;
}
#loginError { margin-top:8px; color:red; }

/* ---------------------- VIDEO GRID ---------------------- */
#videoGrid {
    padding:30px;
    display:grid;
    grid-template-columns: repeat(7, 1fr);
    gap:20px;
    justify-items:center;
}
.card {
    background:var(--card);
    padding:10px;
    width:100%;
    max-width:160px;
    border-radius:10px;
    position:relative;
}
.card video { width:100%; border-radius:8px; }
.card-title { margin-top:8px; font-size:14px; }

.menu-btn {
    position:absolute;
    top:5px;
    right:5px;
    background:none;
    border:none;
    font-weight:bold;
    cursor:pointer;
    color:var(--primary);
    font-size:20px;
}

.menu-box {
    display:none;
    position:absolute;
    top:28px; right:5px;
    background:white;
    color:black;
    border-radius:6px;
    padding:8px;
    width:90px;
    text-align:left;
    box-shadow:0 0 10px #0004;
}
.menu-box button {
    width:100%;
    background:none;
    border:none;
    padding:6px 0;
    text-align:left;
    cursor:pointer;
}

/* ---------------------- VIDEO EKLE POPUP ---------------------- */
#addPopup {
    display:none;
    position:fixed;
    top:0; left:0;
    width:100%; height:100%;
    background:#000000aa;
    justify-content:center;
    align-items:center;
    z-index:1000;
}
.popup-box {
    background:var(--card);
    padding:20px;
    width:320px;
    border-radius:12px;
}
.popup-box input {
    width:100%;
    padding:10px;
    margin:10px 0;
    border-radius:6px;
    border:1px solid #444;
}
.popup-box button {
    padding:10px;
    width:100%;
    border:none;
    background:var(--primary);
    color:white;
    font-weight:bold;
    border-radius:6px;
    cursor:pointer;
}

/* ---------------------- YUKARI Ã‡IK ---------------------- */
#topBtn {
    position:fixed;
    right:20px;
    bottom:20px;
    background:var(--primary);
    color:white;
    padding:12px;
    border-radius:50%;
    cursor:pointer;
    font-size:18px;
    display:none;
}
</style>
</head>

<body class="dark">

<!-- ---------------------- GÄ°RÄ°Åž ---------------------- -->
<div id="loginScreen">
    <div class="login-box">
        <h2>OGY MEME ARCHIVE</h2>
        <input id="logUser" placeholder="KullanÄ±cÄ± adÄ±">
        <input id="logPass" type="password" placeholder="Åžifre">
        <button onclick="attemptLogin()">GiriÅŸ Yap</button>
        <p id="loginError"></p>
    </div>
</div>

<!-- ---------------------- NAVBAR ---------------------- -->
<div class="navbar">
    <div class="logo">OGY MEME ARCHIVE</div>
    <div>
        <button class="icon-btn" onclick="toggleTheme()">ðŸŒ—</button>
        <button class="icon-btn" onclick="openAddPopup()">âž•</button>
    </div>
</div>

<!-- ---------------------- VIDEO GRID ---------------------- -->
<div id="videoGrid"></div>

<!-- ---------------------- YUKARI Ã‡IK ---------------------- -->
<div id="topBtn" onclick="window.scrollTo({top:0, behavior:'smooth'})">â¬†</div>

<!-- ---------------------- VIDEO EKLE POPUP ---------------------- -->
<div id="addPopup">
    <div class="popup-box">
        <h3>Video Ekle</h3>
        <input id="videoName" placeholder="Video adÄ±">
        <input id="videoFile" type="file" accept="video/*">
        <button onclick="saveVideo()">Kaydet</button>
        <button style="margin-top:8px;background:#d9534f" onclick="closeAddPopup()">Kapat</button>
    </div>
</div>

<script>
/* ===========================================================
   LOGIN
=========================================================== */
function attemptLogin(){
    let u = document.getElementById("logUser").value;
    let p = document.getElementById("logPass").value;

    if(u==="ogy" && p==="1881"){
        document.getElementById("loginScreen").style.display="none";
    } else {
        document.getElementById("loginError").innerText="HatalÄ± giriÅŸ!";
        setTimeout(()=>location.reload(), 1200);
    }
}

/* ===========================================================
   TEMA DEÄžÄ°ÅžTÄ°RME
=========================================================== */
function toggleTheme(){
    document.body.classList.toggle("light");
    document.body.classList.toggle("dark");
}

/* ===========================================================
   POPUP
=========================================================== */
function openAddPopup(){ document.getElementById("addPopup").style.display="flex"; }
function closeAddPopup(){ document.getElementById("addPopup").style.display="none"; }

/* ===========================================================
   INDEXEDDB â€” KALICI KAYIT
=========================================================== */
let db;
let request = indexedDB.open("OGY_Meme_DB", 1);

request.onupgradeneeded = function(){
    db = request.result;
    db.createObjectStore("videos", { keyPath:"id", autoIncrement:true });
};

request.onsuccess = function(){
    db = request.result;
    loadVideos();
};

function saveVideo(){
    let name = document.getElementById("videoName").value;
    let file = document.getElementById("videoFile").files[0];
    if(!name || !file) return;

    let reader = new FileReader();
    reader.onload = function(){
        let data = { title:name, video:reader.result };
        let tx = db.transaction("videos","readwrite");
        tx.objectStore("videos").add(data);
        tx.oncomplete = () => { loadVideos(); closeAddPopup(); };
    };
    reader.readAsDataURL(file);
}

/* ===========================================================
   VIDEO YÃœKLEME & SÄ°LME
=========================================================== */
function loadVideos(){
    let grid = document.getElementById("videoGrid");
    grid.innerHTML="";

    let tx = db.transaction("videos","readonly");
    let store = tx.objectStore("videos");

    store.openCursor().onsuccess = function(e){
        let cursor = e.target.result;
        if(cursor){
            let item = cursor.value;

            let div = document.createElement("div");
            div.className="card";

            div.innerHTML = `
                <button class="menu-btn" onclick="toggleMenu(this)">â‹®</button>
                <div class="menu-box">
                    <button onclick="deleteVideo(${item.id})">Sil</button>
                </div>
                <video controls src="${item.video}"></video>
                <div class="card-title">${item.title}</div>
            `;

            document.getElementById("videoGrid").appendChild(div);
            cursor.continue();
        }
    }
}

function toggleMenu(btn){
    let box = btn.nextElementSibling;
    box.style.display = box.style.display==="block" ? "none" : "block";
}

function deleteVideo(id){
    let tx = db.transaction("videos","readwrite");
    tx.objectStore("videos").delete(id);
    tx.oncomplete = ()=>loadVideos();
}

/* ===========================================================
   YUKARI Ã‡IK BUTONU
=========================================================== */
window.onscroll = function(){
    let b = document.getElementById("topBtn");
    b.style.display = window.scrollY>200 ? "block" : "none";
};
</script>
</body>
</html>
